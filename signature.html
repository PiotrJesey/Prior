<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form with Two Signatures and Multiple Fields</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        canvas {
            border: 1px solid #000;
            background: #fff;
            cursor: crosshair;
        }
        .container {
            width: 300px;
            margin: auto;
        }
        .section {
            margin-bottom: 20px;
            text-align: left;
        }
    </style>
</head>
<body>

    <h2>Multi-Field Signature Form</h2>
    <div class="container">
        <div class="section">
            <label for="name">Full Name:</label>
            <input type="text" id="name" name="name">
        </div>

        <div class="section">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email">
        </div>

        <div class="section">
            <label>Choose a Category:</label><br>
            <input type="radio" name="category" value="Option A"> Option A<br>
            <input type="radio" name="category" value="Option B"> Option B<br>
            <input type="radio" name="category" value="Option C"> Option C<br>
        </div>

        <div class="section">
            <label for="comments">Additional Comments:</label><br>
            <textarea id="comments" name="comments" rows="3" cols="30"></textarea>
        </div>

        <div class="section">
            <label>Signature 1:</label><br>
            <canvas id="signatureCanvas1" width="300" height="100"></canvas><br>
            <button onclick="clearSignature(1)">Clear</button>
        </div>

        <div class="section">
            <label>Signature 2:</label><br>
            <canvas id="signatureCanvas2" width="300" height="100"></canvas><br>
            <button onclick="clearSignature(2)">Clear</button>
        </div>

        <button onclick="generateLink()">Generate Pre-filled Link</button>
        <p><a id="generatedLink" href="#" target="_blank"></a></p>
    </div>

    <script>
        let formData = {}; // Stores form data

        // Signature handling for two canvases
        function setupSignatureCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext("2d");
            let drawing = false;

            canvas.addEventListener("mousedown", () => drawing = true);
            canvas.addEventListener("mouseup", () => drawing = false);
            canvas.addEventListener("mousemove", (event) => draw(event, canvas, ctx));

            return { canvas, ctx };
        }

        function draw(event, canvas, ctx) {
            if (!event.buttons) return;
            ctx.lineWidth = 2;
            ctx.lineCap = "round";
            ctx.strokeStyle = "black";

            ctx.lineTo(event.offsetX, event.offsetY);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(event.offsetX, event.offsetY);
        }

        function clearSignature(index) {
            if (index === 1) {
                signature1.ctx.clearRect(0, 0, signature1.canvas.width, signature1.canvas.height);
            } else if (index === 2) {
                signature2.ctx.clearRect(0, 0, signature2.canvas.width, signature2.canvas.height);
            }
        }

        function generateLink() {
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const comments = document.getElementById("comments").value;
            const signature1Data = signature1.canvas.toDataURL(); // Convert signature 1 to Base64
            const signature2Data = signature2.canvas.toDataURL(); // Convert signature 2 to Base64

            // Get selected radio button value
            const categoryRadios = document.getElementsByName("category");
            let selectedCategory = "";
            for (let radio of categoryRadios) {
                if (radio.checked) {
                    selectedCategory = radio.value;
                    break;
                }
            }

            // Store data in URL
            const params = new URLSearchParams();
            params.set("name", name);
            params.set("email", email);
            params.set("category", selectedCategory);
            params.set("comments", comments);
            params.set("signature1", encodeURIComponent(signature1Data));
            params.set("signature2", encodeURIComponent(signature2Data));

            const link = window.location.href.split('?')[0] + "?" + params.toString();
            document.getElementById("generatedLink").href = link;
            document.getElementById("generatedLink").textContent = link;
        }

        // Restore pre-filled data from URL
        function loadFromURL() {
            const params = new URLSearchParams(window.location.search);
            if (params.has("name")) {
                document.getElementById("name").value = params.get("name");
            }
            if (params.has("email")) {
                document.getElementById("email").value = params.get("email");
            }
            if (params.has("comments")) {
                document.getElementById("comments").value = params.get("comments");
            }
            if (params.has("category")) {
                const categoryValue = params.get("category");
                const categoryRadios = document.getElementsByName("category");
                for (let radio of categoryRadios) {
                    if (radio.value === categoryValue) {
                        radio.checked = true;
                        break;
                    }
                }
            }
            if (params.has("signature1")) {
                const img1 = new Image();
                img1.src = decodeURIComponent(params.get("signature1"));
                img1.onload = function () {
                    signature1.ctx.drawImage(img1, 0, 0);
                };
            }
            if (params.has("signature2")) {
                const img2 = new Image();
                img2.src = decodeURIComponent(params.get("signature2"));
                img2.onload = function () {
                    signature2.ctx.drawImage(img2, 0, 0);
                };
            }
        }

        // Initialize canvases
        const signature1 = setupSignatureCanvas("signatureCanvas1");
        const signature2 = setupSignatureCanvas("signatureCanvas2");

        // Load pre-filled data on page load
        window.onload = loadFromURL;
        generateLink()
    </script>

</body>
</html>
